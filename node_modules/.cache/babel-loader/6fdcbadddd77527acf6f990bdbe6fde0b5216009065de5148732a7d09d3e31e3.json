{"ast":null,"code":"import _slicedToArray from\"D:/Warcraft/AAW-Talent-Calculator-master/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useReducer,useContext}from\"react\";import{isTalentUnlocked,isTalentMaxed,getPointsLeft,getTalentRank,getTalentDependents}from\"./selectors\";import{makeReducer}from\"./reducer\";var createInitialState=function createInitialState(data){return Object.entries(data).reduce(function(prev,_ref){var _ref2=_slicedToArray(_ref,2),treeName=_ref2[0],tree=_ref2[1];prev[treeName]=Object.keys(tree.talents).reduce(function(prev,talentName){prev[talentName]=0;return prev;},{});return prev;},{});};var TalentContext=/*#__PURE__*/createContext(null);export var createTalentProvider=function createTalentProvider(data){var initialState=createInitialState(data);return function(_ref3){var children=_ref3.children;var _useReducer=useReducer(makeReducer(initialState),initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var spendPoint=function spendPoint(tree,talent){var pointsLeft=getPointsLeft(state);var unlocked=isTalentUnlocked(state,data,tree,talent);var maxed=isTalentMaxed(state,data,tree,talent);if(unlocked&&!maxed&&pointsLeft>0){dispatch({type:\"POINT_SPENT\",tree:tree,talent:talent});}};var unspendPoint=function unspendPoint(tree,talent){var rank=getTalentRank(state,tree,talent);var dependents=getTalentDependents(state,data,tree,talent);if(dependents.length===0&&rank>0){dispatch({type:\"POINT_UNSPENT\",tree:tree,talent:talent});}};var resetTree=function resetTree(tree){dispatch({type:\"TREE_RESET\",tree:tree});};var resetAll=function resetAll(){dispatch({type:\"ALL_RESET\"});};var restoreState=function restoreState(newState){dispatch({type:\"STATE_RESTORED\",newState:newState});};var value={state:state,data:data,spendPoint:spendPoint,unspendPoint:unspendPoint,resetTree:resetTree,resetAll:resetAll,restoreState:restoreState};return/*#__PURE__*/React.createElement(TalentContext.Provider,{value:value},children);};};export var useTalentContext=function useTalentContext(){var context=useContext(TalentContext);if(context===null){throw new Error(\"Components using useTalentContext must be children of TalentContextProvider\");}return context;};","map":{"version":3,"names":["React","createContext","useReducer","useContext","isTalentUnlocked","isTalentMaxed","getPointsLeft","getTalentRank","getTalentDependents","makeReducer","createInitialState","data","Object","entries","reduce","prev","_ref","_ref2","_slicedToArray","treeName","tree","keys","talents","talentName","TalentContext","createTalentProvider","initialState","_ref3","children","_useReducer","_useReducer2","state","dispatch","spendPoint","talent","pointsLeft","unlocked","maxed","type","unspendPoint","rank","dependents","length","resetTree","resetAll","restoreState","newState","value","createElement","Provider","useTalentContext","context","Error"],"sources":["D:/Warcraft/AAW-Talent-Calculator-master/src/TalentContext/TalentContext.tsx"],"sourcesContent":["import React, { createContext, useReducer, useContext } from \"react\";\r\n\r\nimport { State, TalentData } from \"./types\";\r\nimport {\r\n  isTalentUnlocked,\r\n  isTalentMaxed,\r\n  getPointsLeft,\r\n  getTalentRank,\r\n  getTalentDependents,\r\n} from \"./selectors\";\r\nimport { makeReducer } from \"./reducer\";\r\n\r\nconst createInitialState = (data: TalentData) =>\r\n  Object.entries(data).reduce<State>((prev, [treeName, tree]) => {\r\n    prev[treeName] = Object.keys(tree.talents).reduce<Record<string, number>>(\r\n      (prev, talentName) => {\r\n        prev[talentName] = 0;\r\n        return prev;\r\n      },\r\n      {},\r\n    );\r\n    return prev;\r\n  }, {});\r\n\r\nconst TalentContext = createContext<{\r\n  state: State;\r\n  data: TalentData;\r\n  spendPoint: (tree: string, talent: string) => void;\r\n  unspendPoint: (tree: string, talent: string) => void;\r\n  resetTree: (tree: string) => void;\r\n  resetAll: () => void;\r\n  restoreState: (newState: State) => void;\r\n} | null>(null);\r\n\r\nexport const createTalentProvider = (data: TalentData): React.FC => {\r\n  const initialState = createInitialState(data);\r\n\r\n  return ({ children }) => {\r\n    const [state, dispatch] = useReducer(\r\n      makeReducer(initialState),\r\n      initialState,\r\n    );\r\n\r\n    const spendPoint = (tree: string, talent: string) => {\r\n      const pointsLeft = getPointsLeft(state);\r\n      const unlocked = isTalentUnlocked(state, data, tree, talent);\r\n      const maxed = isTalentMaxed(state, data, tree, talent);\r\n\r\n      if (unlocked && !maxed && pointsLeft > 0) {\r\n        dispatch({ type: \"POINT_SPENT\", tree, talent });\r\n      }\r\n    };\r\n\r\n    const unspendPoint = (tree: string, talent: string) => {\r\n      const rank = getTalentRank(state, tree, talent);\r\n      const dependents = getTalentDependents(state, data, tree, talent);\r\n\r\n      if (dependents.length === 0 && rank > 0) {\r\n        dispatch({\r\n          type: \"POINT_UNSPENT\",\r\n          tree,\r\n          talent,\r\n        });\r\n      }\r\n    };\r\n\r\n    const resetTree = (tree: string) => {\r\n      dispatch({ type: \"TREE_RESET\", tree });\r\n    };\r\n\r\n    const resetAll = () => {\r\n      dispatch({ type: \"ALL_RESET\" });\r\n    };\r\n\r\n    const restoreState = (newState: State) => {\r\n      dispatch({ type: \"STATE_RESTORED\", newState });\r\n    };\r\n\r\n    const value = {\r\n      state,\r\n      data,\r\n      spendPoint,\r\n      unspendPoint,\r\n      resetTree,\r\n      resetAll,\r\n      restoreState,\r\n    };\r\n\r\n    return (\r\n      <TalentContext.Provider value={value}>{children}</TalentContext.Provider>\r\n    );\r\n  };\r\n};\r\n\r\nexport const useTalentContext = () => {\r\n  const context = useContext(TalentContext);\r\n\r\n  if (context === null) {\r\n    throw new Error(\r\n      \"Components using useTalentContext must be children of TalentContextProvider\",\r\n    );\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}