{"ast":null,"code":"import React,{useEffect}from\"react\";import{withRouter,matchPath}from\"react-router-dom\";import\"./KlassTrees.css\";import{config}from\"../config\";import{useTalentContext,getPointsLeft,getTreePointsSpent,getStateFromHash,getHashFromState}from\"../TalentContext\";import{TalentTree}from\"../components/TalentTree\";import{ClearButton}from\"../components/ClearButton\";export var KlassTrees=withRouter(function(_ref){var klass=_ref.klass,location=_ref.location,history=_ref.history;var _useTalentContext=useTalentContext(),state=_useTalentContext.state,data=_useTalentContext.data,resetAll=_useTalentContext.resetAll,restoreState=_useTalentContext.restoreState;var pointsLeft=getPointsLeft(state);var treeNames=Object.keys(data);var treePointsSpent=treeNames.map(function(treeName){return getTreePointsSpent(state,treeName);}).join(\"/\");var requiredLevel=config.TOTAL_POINTS-pointsLeft+config.FIRST_POINT_LEVEL-1;// TODO: move this into a hook?\nuseEffect(function(){var match=matchPath(location.pathname,{path:\"/:klass/:skills\"});var hash=match&&match.params&&match.params.skills;if(hash){restoreState(getStateFromHash(data,hash));}},[]);useEffect(function(){var match=matchPath(location.pathname,{path:\"/:klass\"});var klass=match&&match.params&&match.params.klass;var skillHash=getHashFromState(state);if(skillHash){history.replace(\"/\".concat(klass,\"/\").concat(skillHash));}else{history.replace(\"/\".concat(klass));}},[state]);return/*#__PURE__*/React.createElement(\"div\",{className:\"KlassTrees-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"KlassTrees\"},/*#__PURE__*/React.createElement(\"div\",{className:\"KlassTrees-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"KlassTrees-titleArea\"},/*#__PURE__*/React.createElement(\"h1\",null,klass,\" \",treePointsSpent),/*#__PURE__*/React.createElement(\"p\",{className:\"KlassTrees-summary\"},\"Required level: \",requiredLevel>=10?requiredLevel:\"-\"),/*#__PURE__*/React.createElement(\"p\",{className:\"KlassTrees-summary\"},\"Points left: \",pointsLeft)),/*#__PURE__*/React.createElement(ClearButton,{onClick:function onClick(){return resetAll();}},\"Clear all\")),/*#__PURE__*/React.createElement(\"div\",{className:\"KlassTrees-list\"},treeNames.map(function(name){return/*#__PURE__*/React.createElement(TalentTree,{key:name,name:name});}))));});","map":{"version":3,"names":["React","useEffect","withRouter","matchPath","config","useTalentContext","getPointsLeft","getTreePointsSpent","getStateFromHash","getHashFromState","TalentTree","ClearButton","KlassTrees","_ref","klass","location","history","_useTalentContext","state","data","resetAll","restoreState","pointsLeft","treeNames","Object","keys","treePointsSpent","map","treeName","join","requiredLevel","TOTAL_POINTS","FIRST_POINT_LEVEL","match","pathname","path","hash","params","skills","skillHash","replace","concat","createElement","className","onClick","name","key"],"sources":["D:/Warcraft/AAW-Talent-Calculator-master/src/views/KlassTrees.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { withRouter, matchPath, RouteComponentProps } from \"react-router-dom\";\r\n\r\nimport \"./KlassTrees.css\";\r\nimport { config } from \"../config\";\r\nimport {\r\n  useTalentContext,\r\n  getPointsLeft,\r\n  getTreePointsSpent,\r\n  getStateFromHash,\r\n  getHashFromState,\r\n} from \"../TalentContext\";\r\nimport { TalentTree } from \"../components/TalentTree\";\r\nimport { ClearButton } from \"../components/ClearButton\";\r\n\r\ninterface Props extends RouteComponentProps {\r\n  klass: string;\r\n}\r\n\r\nexport const KlassTrees = withRouter<Props, React.FC<Props>>(\r\n  ({ klass, location, history }) => {\r\n    const { state, data, resetAll, restoreState } = useTalentContext();\r\n\r\n    const pointsLeft = getPointsLeft(state);\r\n    const treeNames = Object.keys(data);\r\n    const treePointsSpent = treeNames\r\n      .map(treeName => getTreePointsSpent(state, treeName))\r\n      .join(\"/\");\r\n\r\n    const requiredLevel =\r\n      config.TOTAL_POINTS - pointsLeft + config.FIRST_POINT_LEVEL - 1;\r\n\r\n    // TODO: move this into a hook?\r\n    useEffect(() => {\r\n      const match = matchPath<{ skills: string }>(location.pathname, {\r\n        path: \"/:klass/:skills\",\r\n      });\r\n      const hash = match && match.params && match.params.skills;\r\n      if (hash) {\r\n        restoreState(getStateFromHash(data, hash));\r\n      }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n      const match = matchPath<{ klass: string }>(location.pathname, {\r\n        path: \"/:klass\",\r\n      });\r\n      const klass = match && match.params && match.params.klass;\r\n      const skillHash = getHashFromState(state);\r\n      if (skillHash) {\r\n        history.replace(`/${klass}/${skillHash}`);\r\n      } else {\r\n        history.replace(`/${klass}`);\r\n      }\r\n    }, [state]);\r\n\r\n    return (\r\n      <div className=\"KlassTrees-container\">\r\n        <div className=\"KlassTrees\">\r\n          <div className=\"KlassTrees-header\">\r\n            <div className=\"KlassTrees-titleArea\">\r\n              <h1>\r\n                {klass} {treePointsSpent}\r\n              </h1>\r\n              <p className=\"KlassTrees-summary\">\r\n                Required level: {requiredLevel >= 10 ? requiredLevel : \"-\"}\r\n              </p>\r\n              <p className=\"KlassTrees-summary\">Points left: {pointsLeft}</p>\r\n            </div>\r\n            <ClearButton onClick={() => resetAll()}>Clear all</ClearButton>\r\n          </div>\r\n          <div className=\"KlassTrees-list\">\r\n            {treeNames.map(name => (\r\n              <TalentTree key={name} name={name} />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  },\r\n);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}